<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://via.placeholder.com">
    <title>Yonca - Learning Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #ffffff;
        }

        header {
            background: #ffffff;
            border-bottom: 1px solid #e0e0e0;
            padding: 1rem 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #abc32f;
            display: flex;
            align-items: center;
        }

        .logo img {
            height: 50px;
            width: auto;
        }

        nav {
            margin-top: 1rem;
        }

        nav a {
            color: #333;
            text-decoration: none;
            margin-right: 2rem;
            padding: 0.5rem 0;
            transition: color 0.3s ease;
            font-weight: 500;
        }

        nav a:hover {
            color: #abc32f;
        }

        nav a.active {
            color: #abc32f;
            border-bottom: 2px solid #abc32f;
        }

        main {
            min-height: calc(100vh - 150px);
            padding: 2rem 0;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .hero {
            text-align: center;
            padding: 4rem 0;
            background: #f8fafc;
            margin: -2rem -20px 2rem -20px;
        }

        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            color: #1f2937;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.2rem;
            color: #6b7280;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .section-title {
            font-size: 2.2rem;
            color: #1f2937;
            margin-bottom: 2rem;
            font-weight: 600;
            border-bottom: 3px solid #abc32f;
            padding-bottom: 0.5rem;
        }

        .image-container {
            position: relative;
            overflow: hidden;
        }

        .image-container img {
            transition: opacity 0.3s ease-in-out;
        }

        .image-placeholder {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
            text-align: center;
            color: #9ca3af;
            font-size: 1.1rem;
        }

        .forum-container {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .forum-message {
            background: #ffffff;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid #e5e7eb;
            border-left: 4px solid #abc32f;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .forum-message .user {
            font-weight: 600;
            color: #abc32f;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .forum-message .timestamp {
            font-size: 0.9rem;
            color: #9ca3af;
        }

        .forum-message.current-user {
            border-left-color: #16a34a;
            background: #f0fdf4;
        }

        .message-form {
            background: #ffffff;
            padding: 2rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .message-form h3 {
            color: #1f2937;
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #abc32f;
            box-shadow: 0 0 0 3px rgba(171, 195, 47, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        button {
            background: #abc32f;
            color: white;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background: #809c13;
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .resource-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .resource-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .resource-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .resource-card h3 {
            color: #1f2937;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .resource-card p {
            color: #6b7280;
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .download-btn {
            background: #abc32f;
            color: white;
            padding: 0.6rem 1.5rem;
            text-decoration: none;
            border-radius: 6px;
            display: inline-block;
            transition: background-color 0.3s ease;
            font-weight: 500;
        }

        .download-btn:hover {
            background: #809c13;
        }

        .empty-section {
            background: #f9fafb;
            padding: 4rem 2rem;
            border-radius: 8px;
            text-align: center;
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }

        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .contact-item {
            background: #ffffff;
            padding: 2.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            transition: box-shadow 0.3s ease;
        }

        .contact-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .contact-item h3 {
            color: #1f2937;
            margin-bottom: 1rem;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .contact-item p {
            color: #6b7280;
            line-height: 1.8;
        }

        .about-content {
            background: #ffffff;
            padding: 3rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            margin-top: 2rem;
        }

        .about-content h2 {
            color: #1f2937;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.6rem;
            font-weight: 600;
        }

        .about-content p {
            color: #6b7280;
            margin-bottom: 1.2rem;
            line-height: 1.8;
        }

        .about-content ul {
            margin-left: 2rem;
            color: #6b7280;
            margin-bottom: 1.5rem;
        }

        .about-content li {
            margin-bottom: 0.5rem;
        }

        footer {
            background: #1f2937;
            color: #9ca3af;
            text-align: center;
            padding: 3rem 0;
            margin-top: 4rem;
            border-top: 1px solid #374151;
        }

        footer p {
            margin: 0.5rem 0;
            font-size: 0.95rem;
        }

        footer a {
            color: #abc32f;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Auth buttons styling */
        #auth-buttons button {
            background: white;
            color: #667eea;
            border: 1px solid #667eea;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        #auth-buttons button:hover {
            background: #667eea;
            color: white;
        }

        #user-info {
            color: #374151;
            font-weight: 500;
        }

        #user-info button {
            background: #dc2626;
            color: white;
            border: 1px solid #dc2626;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        #user-info button:hover {
            background: #b91c1c;
            border-color: #b91c1c;
        }

        #user-info a {
            color: #abc32f;
            text-decoration: none;
            font-weight: 500;
        }

        #user-info a:hover {
            text-decoration: underline;
        }

        /* Course cards styling */
        .course-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
        }

        .course-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .course-emoji {
            width: 80px;
            height: 80px;
            margin-right: 1.5rem;
            border-radius: 8px;
            background: linear-gradient(135deg, #abc32f 0%, #809c13 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 36px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .course-info h4 {
            color: #1f2937;
            margin-bottom: 0.5rem;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .course-info p {
            color: #6b7280;
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        .course-info .time-slot {
            color: #374151;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* PDFs styling */
        .pdfs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .pdf-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .pdf-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .pdf-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #abc32f;
        }

        .pdf-card h3 {
            color: #1f2937;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .pdf-card p {
            color: #6b7280;
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .pdf-access-btn {
            background: #abc32f;
            color: white;
            padding: 0.6rem 1.5rem;
            text-decoration: none;
            border-radius: 6px;
            display: inline-block;
            transition: background-color 0.3s ease;
            font-weight: 500;
            border: none;
            cursor: pointer;
            margin-top: 1rem;
        }

        .pdf-access-btn:hover {
            background: #809c13;
        }

        .pin-input {
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .pin-input input {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            letter-spacing: 0.2rem;
        }

        .pin-error {
            color: #dc2626;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.2rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            nav a {
                margin-right: 1rem;
                font-size: 0.9rem;
            }

            .resources-grid {
                grid-template-columns: 1fr;
            }

            .contact-info {
                grid-template-columns: 1fr;
            }

            .course-card {
                flex-direction: column;
                text-align: center;
            }

            .course-emoji {
                margin-right: 0;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <img src="/static/images/Logo.jpeg" alt="Yonca Logo">
            </div>
            <nav>
                <a href="#" onclick="showPage('home')" class="nav-link active">Home</a>
                <a href="#" onclick="showPage('courses')" class="nav-link">Courses</a>
                <a href="#" onclick="showPage('forum')" class="nav-link">Forum</a>
                <a href="#" onclick="showPage('resources')" class="nav-link">Resources</a>
                <a href="#" onclick="showPage('tavi')" class="nav-link">TAVI Test</a>
                <a href="#" onclick="showPage('contacts')" class="nav-link">Contacts</a>
                <a href="#" onclick="showPage('about')" class="nav-link">About Company</a>
            </nav>
            <div id="auth-buttons" style="position: absolute; top: 1rem; right: 20px; display: block;">
                <button id="login-btn" onclick="window.location.href='/login'" style="background: white; color: #667eea; border: 1px solid #667eea; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">Login</button>
            </div>
            <div id="user-info" style="position: absolute; top: 1rem; right: 20px; display: none;">
                <span style="color: #374151; margin-right: 1rem;">Welcome, <span id="user-name"></span>!</span>
                <button onclick="window.location.href='/logout'" style="background: #dc2626; color: white; border: 1px solid #dc2626; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-weight: 500; transition: all 0.3s ease;">Logout</button>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Home Page -->
        <section id="home" class="page active">
            <div class="hero">
                <h1>Welcome to Yonca</h1>
                <p>Your comprehensive learning platform for courses, resources, and community engagement</p>
                <p>Navigate using the menu above to explore our courses, connect with others in our forum, access resources, and learn more about us.</p>
            </div>
            <div id="home-courses" style="display: none; margin-top: 2rem;">
                <h2 class="section-title">Your Enrolled Courses</h2>
                <div id="home-courses-content">
                    <p>Loading your courses...</p>
                </div>
            </div>
        </section>

        <!-- Courses Page -->
        <section id="courses" class="page">
            <h2 class="section-title">Courses</h2>
            <p>Explore your enrolled courses with videos and recorded sessions.</p>
            <div class="courses-placeholder">
                <p>No courses available yet. Check back soon!</p>
                <p style="margin-top: 1rem; font-size: 0.9rem;">This section will display your courses with videos and recordings of sessions.</p>
            </div>
        </section>

        <!-- Forum Page -->
        <section id="forum" class="page">
            <h2 class="section-title">Community Forum</h2>
            
            <div class="message-form">
                <h3>Post a New Message</h3>
                <form onsubmit="postMessage(event)">
                    <div class="form-group">
                        <label for="username">Username:</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Message:</label>
                        <textarea id="message" name="message" required></textarea>
                    </div>
                    <button type="submit">Post Message</button>
                </form>
            </div>

            <div class="forum-container">
                <h3>Recent Messages</h3>
                <div id="messages-container">
                    <div class="forum-message">
                        <div class="user">Welcome to Yonca Forum!</div>
                        <p>This is where community members can connect, ask questions, and share knowledge.</p>
                        <div class="timestamp">Posted on December 8, 2025</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Resources Page -->
        <section id="resources" class="page">
            <h2 class="section-title">Resources Library</h2>
            <p>Download educational materials, reference documents, and access secure PDF files.</p>
            
            <!-- Regular Resources -->
            <h3 style="color: #1f2937; margin: 2rem 0 1rem 0; font-size: 1.4rem; font-weight: 600;">üìö Learning Materials</h3>
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon">üìÑ</div>
                    <h3>Getting Started Guide</h3>
                    <p>A comprehensive guide to help you get started with Yonca platform.</p>
                    <a href="#" class="download-btn">Download PDF</a>
                </div>

                <div class="resource-card">
                    <div class="resource-icon">üìö</div>
                    <h3>Course Materials</h3>
                    <p>Essential course materials and study notes for all courses.</p>
                    <a href="#" class="download-btn">Download PDF</a>
                </div>

                <div class="resource-card">
                    <div class="resource-icon">üìã</div>
                    <h3>Best Practices</h3>
                    <p>Industry best practices and tips for success.</p>
                    <a href="#" class="download-btn">Download PDF</a>
                </div>

                <div class="resource-card">
                    <div class="resource-icon">üéØ</div>
                    <h3>FAQ Document</h3>
                    <p>Frequently asked questions and answers about our platform.</p>
                    <a href="#" class="download-btn">Download PDF</a>
                </div>
            </div>

            <!-- PDF Upload Section (Admin Only) -->
            <div id="pdf-upload-section" style="display: none;">
                <h3 style="color: #1f2937; margin: 3rem 0 1rem 0; font-size: 1.4rem; font-weight: 600;">üì§ Upload PDF Document</h3>
                <p style="color: #6b7280; margin-bottom: 2rem;">Upload a PDF document to share securely with PIN protection.</p>
                
                <div class="upload-form" style="background: #f8fafc; padding: 2rem; border-radius: 8px; margin-bottom: 3rem;">
                    <form id="pdf-upload-form" enctype="multipart/form-data">
                    <div style="margin-bottom: 1rem;">
                        <label for="pdf-title" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #374151;">Document Title</label>
                        <input type="text" id="pdf-title" name="title" required style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 6px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="pdf-description" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #374151;">Description</label>
                        <textarea id="pdf-description" name="description" rows="3" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 6px; font-size: 1rem; resize: vertical;"></textarea>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="pdf-file" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #374151;">PDF File</label>
                        <input type="file" id="pdf-file" name="file" accept=".pdf" required style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 6px; font-size: 1rem;">
                    </div>
                    
                    <div style="margin-bottom: 2rem;">
                        <label for="pdf-pin" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #374151;">Access PIN (Optional - auto-generated if empty)</label>
                        <input type="text" id="pdf-pin" name="pin" maxlength="10" placeholder="Leave empty for auto-generated PIN" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 6px; font-size: 1rem;">
                    </div>
                    
                    <button type="submit" class="upload-btn" style="background: #abc32f; color: white; padding: 0.75rem 2rem; border: none; border-radius: 6px; font-size: 1rem; font-weight: 500; cursor: pointer; transition: background 0.3s ease;">
                        üì§ Upload PDF
                    </button>
                    
                    <div id="upload-status" style="margin-top: 1rem; display: none;"></div>
                </form>
            </div>
            </div>

            <!-- Secure PDFs -->
            <h3 style="color: #1f2937; margin: 3rem 0 1rem 0; font-size: 1.4rem; font-weight: 600;">üîí Secure PDF Documents</h3>
            <p style="color: #6b7280; margin-bottom: 2rem;">Access protected PDF documents with PIN code authentication.</p>
            <div class="pdfs-grid">
                <!-- PDFs will be loaded here -->
            </div>
        </section>

        <!-- TAVI Test Page -->
        <section id="tavi" class="page">
            <h2 class="section-title">TAVI Test</h2>
            <div class="empty-section">
                <p>TAVI Test section is coming soon.</p>
            </div>
        </section>

        <!-- Contacts Page -->
        <section id="contacts" class="page">
            <h2 class="section-title">Contact Us</h2>
            
            <div class="contact-info">
                <div class="contact-item">
                    <h3>ÔøΩ WhatsApp</h3>
                    <p>
                        <a href="https://wa.me/994516237394" target="_blank" style="color: #abc32f; text-decoration: none; font-weight: 500;">
                            +994 51 623 73 94
                        </a><br>
                        Available: Mon-Fri, 9AM-6PM
                    </p>
                </div>

                <div class="contact-item">
                    <h3>üìß Email</h3>
                    <p>
                        <a href="mailto:info@yonca-sdc.com" style="color: #abc32f; text-decoration: none; font-weight: 500;">
                            info@yonca-sdc.com
                        </a>
                    </p>
                </div>

                <div class="contact-item">
                    <h3>üìç Address</h3>
                    <p>
                        M…ôsud ∆èlizad…ô 52<br>
                        Baku, Azerbaijan
                    </p>
                </div>

                <div class="contact-item">
                    <h3>üïê Business Hours</h3>
                    <p>
                        Monday - Friday: 9:00 AM - 6:00 PM<br>
                        Saturday - Sunday: Closed
                    </p>
                </div>

                <div class="contact-item">
                    <h3>üì± Social Media</h3>
                    <p>
                        Follow us on Instagram for updates and announcements<br>
                        <a href="https://www.instagram.com/yonca_ababaku/?hl=en" target="_blank" style="color: #abc32f; text-decoration: none; font-weight: 500;">
                            @yonca_ababaku
                        </a>
                    </p>
                </div>
            </div>
        </section>

        <!-- About Company Page -->
        <section id="about" class="page">
            <h2 class="section-title">About Yonca</h2>
            
            <div class="about-content">
                <h2>Our Mission</h2>
                <p>
                    At Yonca, we are committed to providing accessible, high-quality educational content and fostering a supportive learning community. 
                    Our mission is to empower learners worldwide to achieve their goals through innovative online education.
                </p>

                <h2>Our Vision</h2>
                <p>
                    We envision a world where quality education is accessible to everyone, regardless of their background or location. 
                    We strive to create an inclusive platform that bridges the gap between learners and expert educators.
                </p>

                <h2>Our Values</h2>
                <ul style="margin-left: 2rem; color: #666;">
                    <li><strong>Excellence:</strong> We maintain the highest standards in our courses and services.</li>
                    <li><strong>Community:</strong> We believe in the power of collaborative learning and peer support.</li>
                    <li><strong>Accessibility:</strong> We ensure our platform is accessible to all learners.</li>
                    <li><strong>Innovation:</strong> We continuously evolve to provide the best learning experience.</li>
                    <li><strong>Integrity:</strong> We operate with transparency and honesty in all our dealings.</li>
                </ul>

                <h2>Why Choose Yonca?</h2>
                <ul style="margin-left: 2rem; color: #666;">
                    <li>Expert instructors with real-world experience</li>
                    <li>Comprehensive course library with varied topics</li>
                    <li>Flexible learning at your own pace</li>
                    <li>Active community forum for peer support</li>
                    <li>Rich library of downloadable resources</li>
                    <li>Certificate of completion for each course</li>
                </ul>

                <h2>Contact Information</h2>
                <p>
                    Have questions about our company? Feel free to reach out to us through the <a href="#contacts" onclick="showPage('contacts')">Contacts</a> page.
                </p>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Yonca Learning Platform. All rights reserved.</p>
        <p>Privacy Policy | Terms of Service | Contact Us</p>
    </footer>

    <script>
        const API_BASE = ''; // Relative to same origin

        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function showPage(pageId) {
            // Hide all pages
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));

            // Remove active class from all nav links
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));

            // Show selected page
            const selectedPage = document.getElementById(pageId);
            if (selectedPage) {
                selectedPage.classList.add('active');
                // Load data for specific pages
                if (pageId === 'courses') loadCourses();
                if (pageId === 'forum') loadForumMessages();
                if (pageId === 'resources') {
                    loadResources();
                    loadPDFs();
                }
            }

            // Add active class to clicked nav link
            event.target.classList.add('active');

            // Scroll to top
            window.scrollTo(0, 0);
        }

        async function loadCourses() {
            try {
                console.log('Loading courses...');
                const response = await fetch(`${API_BASE}/api/courses`);
                console.log('Response status:', response.status);
                const courses = await response.json();
                console.log('Courses received:', courses);
                const coursesContainer = document.querySelector('.courses-placeholder');
                if (courses.length > 0) {
                    coursesContainer.innerHTML = '<h3>Your Courses:</h3>';
                    courses.forEach(course => {
                        const courseDiv = document.createElement('div');
                        courseDiv.className = 'course-card';
                        
                        let profilePic = '';
                        if (course.profile_emoji) {
                            // Show configured emoji
                            profilePic = `<div class="course-emoji">${course.profile_emoji}</div>`;
                        } else {
                            // Show default emoji
                            profilePic = '<div class="course-emoji">üìö</div>';
                        }
                        
                        courseDiv.innerHTML = `
                            ${profilePic}
                            <div class="course-info">
                                <h4>${course.title}</h4>
                                <p>${course.description}</p>
                                ${course.time_slot ? `<p class="time-slot"><strong>Time:</strong> ${course.time_slot}</p>` : ''}
                            </div>
                        `;
                        coursesContainer.appendChild(courseDiv);
                    });
                } else {
                    coursesContainer.innerHTML = '<p>No courses available yet. Check back soon!</p>';
                }
            } catch (error) {
                console.error('Error loading courses:', error);
            }
        }

        async function loadForumMessages() {
            try {
                const response = await fetch(`${API_BASE}/api/forum/messages`);
                const messages = await response.json();
                const messagesContainer = document.getElementById('messages-container');
                messagesContainer.innerHTML = '';
                messages.forEach(message => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'forum-message' + (message.is_current_user ? ' current-user' : '');
                    messageDiv.innerHTML = `
                        <div class="user">${escapeHtml(message.username)}${message.is_current_user ? ' (You)' : ''}</div>
                        <p>${escapeHtml(message.message)}</p>
                        <div class="timestamp">Posted on ${new Date(message.timestamp).toLocaleDateString()}</div>
                    `;
                    messagesContainer.appendChild(messageDiv);
                });
            } catch (error) {
                console.error('Error loading forum messages:', error);
            }
        }

        async function loadResources() {
            try {
                const response = await fetch(`${API_BASE}/api/resources`);
                const resources = await response.json();
                const resourcesGrid = document.querySelector('.resources-grid');
                resourcesGrid.innerHTML = '';
                if (resources.length > 0) {
                    resources.forEach(resource => {
                        const resourceCard = document.createElement('div');
                        resourceCard.className = 'resource-card';
                        resourceCard.innerHTML = `
                            <div class="resource-icon">üìÑ</div>
                            <h3>${resource.title}</h3>
                            <p>${resource.description}</p>
                            <a href="${resource.file_url}" class="download-btn" target="_blank">Download PDF</a>
                        `;
                        resourcesGrid.appendChild(resourceCard);
                    });
                } else {
                    resourcesGrid.innerHTML = '<p>No resources available yet.</p>';
                }
            } catch (error) {
                console.error('Error loading resources:', error);
            }
        }

        async function loadPDFs() {
            try {
                const response = await fetch(`${API_BASE}/api/pdfs`);
                const pdfs = await response.json();
                const pdfsGrid = document.querySelector('.pdfs-grid');
                pdfsGrid.innerHTML = '';
                if (pdfs.length > 0) {
                    pdfs.forEach(pdf => {
                        const pdfCard = document.createElement('div');
                        pdfCard.className = 'pdf-card';
                        pdfCard.innerHTML = `
                            <div class="pdf-icon">üìï</div>
                            <h3>${pdf.title}</h3>
                            <p>${pdf.description || 'Secure PDF document'}</p>
                            <div class="pin-input">
                                <input type="password" id="pin-${pdf.id}" placeholder="Enter PIN" maxlength="10">
                                <button class="pdf-access-btn" onclick="accessPDF(${pdf.id})">Access PDF</button>
                                <div id="error-${pdf.id}" class="pin-error" style="display: none;"></div>
                            </div>
                        `;
                        pdfsGrid.appendChild(pdfCard);
                    });
                } else {
                    pdfsGrid.innerHTML = '<p>No PDF documents available yet.</p>';
                }
            } catch (error) {
                console.error('Error loading PDFs:', error);
            }
        }

        async function accessPDF(pdfId) {
            const pinInput = document.getElementById(`pin-${pdfId}`);
            const errorDiv = document.getElementById(`error-${pdfId}`);
            const pin = pinInput.value.trim();
            
            if (!pin) {
                errorDiv.textContent = 'Please enter a PIN';
                errorDiv.style.display = 'block';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/api/pdfs/${pdfId}/access`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ pin: pin }),
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    // Success - open download link
                    window.open(`${API_BASE}/api/pdfs/${pdfId}/download/${pin}`, '_blank');
                    errorDiv.style.display = 'none';
                    pinInput.value = '';
                    alert('PDF downloaded successfully!');
                } else {
                    errorDiv.textContent = result.error || 'Access denied';
                    errorDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Error accessing PDF:', error);
                errorDiv.textContent = 'Network error. Please try again.';
                errorDiv.style.display = 'block';
            }
        }

        async function uploadPDF(event) {
            event.preventDefault();
            
            const form = document.getElementById('pdf-upload-form');
            const statusDiv = document.getElementById('upload-status');
            const submitBtn = form.querySelector('button[type="submit"]');
            
            const formData = new FormData();
            formData.append('title', document.getElementById('pdf-title').value);
            formData.append('description', document.getElementById('pdf-description').value);
            formData.append('file', document.getElementById('pdf-file').files[0]);
            
            const pinValue = document.getElementById('pdf-pin').value.trim();
            if (pinValue) {
                formData.append('pin', pinValue);
            }
            
            // Disable button and show loading
            submitBtn.disabled = true;
            submitBtn.textContent = 'Uploading...';
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '<span style="color: #6b7280;">Uploading PDF...</span>';
            
            try {
                const response = await fetch(`${API_BASE}/api/pdfs/upload`, {
                    method: 'POST',
                    body: formData,
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    statusDiv.innerHTML = `<span style="color: #059669;">‚úÖ PDF uploaded successfully! Access PIN: <strong>${result.pin}</strong></span>`;
                    
                    // Clear form
                    form.reset();
                    
                    // Reload PDFs
                    loadPDFs();
                    
                    // Show success message
                    setTimeout(() => {
                        alert(`PDF "${result.title}" uploaded successfully!\n\nAccess PIN: ${result.pin}\n\nKeep this PIN safe to share the document.`);
                    }, 500);
                } else {
                    statusDiv.innerHTML = `<span style="color: #dc2626;">‚ùå Error: ${result.error || 'Upload failed'}</span>`;
                }
            } catch (error) {
                console.error('Error uploading PDF:', error);
                statusDiv.innerHTML = '<span style="color: #dc2626;">‚ùå Network error. Please try again.</span>';
            } finally {
                // Re-enable button
                submitBtn.disabled = false;
                submitBtn.textContent = 'üì§ Upload PDF';
            }
        }

        async function postMessage(event) {
            event.preventDefault();

            let username;
            if (window.currentUser) {
                username = window.currentUser.username;
            } else {
                username = document.getElementById('username').value;
            }

            const message = document.getElementById('message').value;

            if (!username || username.trim() === '' || message.trim() === '') {
                alert('Please fill in all fields');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/forum/messages`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, message }),
                });

                if (response.ok) {
                    // Reload messages
                    loadForumMessages();
                    // Clear form
                    if (!window.currentUser) {
                        document.getElementById('username').value = '';
                    }
                    document.getElementById('message').value = '';
                    alert('Message posted successfully!');
                } else {
                    alert('Error posting message');
                }
            } catch (error) {
                console.error('Error posting message:', error);
                alert('Error posting message');
            }
        }

        function showHomeCourses(courses) {
            const homeCoursesDiv = document.getElementById('home-courses');
            const contentDiv = document.getElementById('home-courses-content');
            
            if (courses && courses.length > 0) {
                contentDiv.innerHTML = '';
                courses.forEach(course => {
                    const courseDiv = document.createElement('div');
                    courseDiv.className = 'course-card';
                    
                    let profilePic = '';
                    if (course.profile_emoji) {
                        // Show configured emoji
                        profilePic = `<div class="course-emoji">${course.profile_emoji}</div>`;
                    } else {
                        // Show default emoji
                        profilePic = '<div class="course-emoji">üìö</div>';
                    }
                    
                    courseDiv.innerHTML = `
                        ${profilePic}
                        <div class="course-info">
                            <h4>${course.title}</h4>
                            <p>${course.description}</p>
                            ${course.time_slot ? `<p class="time-slot"><strong>Time:</strong> ${course.time_slot}</p>` : ''}
                        </div>
                    `;
                    contentDiv.appendChild(courseDiv);
                });
                homeCoursesDiv.style.display = 'block';
            } else {
                contentDiv.innerHTML = '<p>You are not enrolled in any courses yet. Visit the <a href="#" onclick="showPage(\'courses\')">Courses</a> page to browse available courses.</p>';
                homeCoursesDiv.style.display = 'block';
            }
        }

        function hideHomeCourses() {
            document.getElementById('home-courses').style.display = 'none';
        }

        async function checkUser() {
            try {
                console.log('Checking user login status...');
                const response = await fetch(`${API_BASE}/api/user`);
                console.log('User check response status:', response.status);
                if (response.ok) {
                    const user = await response.json();
                    console.log('User logged in:', user);
                    document.getElementById('auth-buttons').style.display = 'none';
                    document.getElementById('user-info').style.display = 'block';
                    document.getElementById('user-name').textContent = user.username;
                    window.currentUser = user;
                    updateForumForm(true);
                    showHomeCourses(user.courses);
                    
                    // Show PDF upload section for admins
                    if (user.is_admin) {
                        document.getElementById('pdf-upload-section').style.display = 'block';
                    }
                } else {
                    console.log('User not logged in');
                    document.getElementById('auth-buttons').style.display = 'block';
                    document.getElementById('user-info').style.display = 'none';
                    window.currentUser = null;
                    updateForumForm(false);
                    hideHomeCourses();
                    
                    // Hide PDF upload section for non-admin users
                    document.getElementById('pdf-upload-section').style.display = 'none';
                }
            } catch (error) {
                console.error('Error checking user:', error);
                document.getElementById('auth-buttons').style.display = 'block';
                document.getElementById('user-info').style.display = 'none';
                window.currentUser = null;
                updateForumForm(false);
                hideHomeCourses();
                
                // Hide PDF upload section for non-admin users
                document.getElementById('pdf-upload-section').style.display = 'none';
            }
        }

        function updateForumForm(isLoggedIn) {
            const usernameGroup = document.querySelector('.form-group');
            if (isLoggedIn) {
                usernameGroup.style.display = 'none';
            } else {
                usernameGroup.style.display = 'block';
            }
        }

        // Load initial data
        document.addEventListener('DOMContentLoaded', () => {
            checkUser();
            loadForumMessages();
            
            // Add PDF upload form listener
            const pdfUploadForm = document.getElementById('pdf-upload-form');
            if (pdfUploadForm) {
                pdfUploadForm.addEventListener('submit', uploadPDF);
            }
        });
    </script>
</body>
</html>
